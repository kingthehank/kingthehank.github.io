<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The History of the Animal</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/EB-Garamond/4.400/eb-garamond.css" rel="stylesheet">
    <style>
        body {
            font-family: 'EB Garamond', Garamond, serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            font-size: 21px;
            line-height: 1.6;
        }
        .container {
            padding: 20px;
        }
        #randomText {
            margin: 30px 0;
            text-align: justify;
            font-size: 21px;
        }
        button {
            font-family: 'EB Garamond', Garamond, serif;
            padding: 12px 24px;
            margin-right: 10px;
            margin-bottom: 20px;
            background-color: #f0f0f0;
            border: 1px solid #000;
            cursor: pointer;
            font-size: 19px;
        }
        button:hover {
            background-color: #e0e0e0;
        }
        h1 {
            font-family: 'EB Garamond', Garamond, serif;
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: normal;
        }
        .byline {
            font-family: 'EB Garamond', Garamond, serif;
            font-size: 19px;
            margin-bottom: 30px;
            font-weight: normal;
        }
        .copyright {
            font-family: 'EB Garamond', Garamond, serif;
            font-size: 16px;
            margin-top: 40px;
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Polar, After "The Bear and the Moon" by Joanne Ryder</h1>
        <div class="byline">by Hannah Perrin King in collaboration with, as randomized by, the user</div>

        <button id="poemButton">Generate New Poem</button>
        
        <div id="randomText"></div>
        <div id="debug" style="color: #999; font-size: 14px; margin-top: 10px;"></div>

        <div class="copyright">
            Â© 2024 Hannah Perrin King. All rights reserved.
        </div>
    </div>

    <script>
        // Debug function
        function debug(message) {
            document.getElementById('debug').textContent += message + "\n";
            console.log(message);
        }

        // Try to detect JS errors
        window.onerror = function(message, source, lineno, colno, error) {
            debug("Error: " + message + " at line " + lineno);
            return false;
        };

        debug("Script loaded");

        const sentences = [
            "The sea was limitless.",
            "The moon was limited.",
            "She swan.",
            "She swan until she was tired.",
            "She swam.",
            "She swam.",
            "She swam.",
            "Was it not enough?",
            "Were the children, their wet paws, not the moon and back?",
            "The library closed.",
            "The books were confiscated.",
            "Her nose pushed out of the sea like a bow nevertheless.",
            "The sea closed in.",
            "The time neared.",
            "The cubs drowned.",
            "Her cubs were born.",
            "The moon rose like a sun.",
            "The land melted.",
            "She wept, maybe, or it was the sea.",
            "Her paws were so big, and not big enough.",
            "Her paws were big, like paddles, parting the sea.", 
            "The sea, it swallowed her whole.", 
            "The moon's expression did not change.", 
            "A photographer arrived on the continent.",
            "People took pictures.",
            "It was written about.",
            "The books were burned, the sun a match.", 
            "The ice burned, the sun a match.",
            "Much sadness.",
            "The moon was a restless search light.", 
            "Her big, wet paws searched for land.",
            "She was the color of a milk carton.",
            "Her kids weren't on a milk cartoon.",
            "The milk carton floated by, a waxy, little, immutable iceberg.",
            "The people gathered.",
            "The people left."
        ];

        debug("Sentences array loaded with " + sentences.length + " items");

        function shuffleArray(array) {
            debug("Shuffling array...");
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            debug("Array shuffled");
            return array;
        }

        function generateNewPoem() {
            debug("generateNewPoem function called");
            const randomized = shuffleArray([...sentences]);
            debug("Array randomized, joining...");
            const poemText = randomized.join(' ');
            document.getElementById('randomText').textContent = poemText;
            debug("Poem generated and displayed with " + randomized.length + " sentences");
        }

        // Add event listener instead of inline onclick
        document.getElementById('poemButton').addEventListener('click', function() {
            debug("Button clicked");
            generateNewPoem();
        });

        debug("Event listener attached to button");
    </script>
</body>
</html>
